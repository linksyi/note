## 事务隔离级别

### 隔离性与隔离级别

提到事务，就得说说ACID(Atomicity、Consistency、Isolation、Durability，原子性、一致性、隔离性、持久性)

#### 隔离级别

- 读未提交：一个事务还没提交时，它做的更变就能被其他事务看到
- 读提交：一个事务提交后，其他事务才能看到更变
- 可重复度：一个事务从开始到结束时看到的数据是一致的
- 串行化：事务开启，读会加读锁，写会加写锁，当锁冲突时，线程需要等待持有锁的线程释放锁资源

### 事务隔离的实现

在MySQL中，实际上每条记录在更新的时候都会同时记录一条回滚操作。记录上的最新值，通过回滚操作，都可以得到前一个状态的值。

同一条记录在数据库中可以存在多个版本，也就是MySQL的多版本并发控制(MVCC)机制。

#### 事务的启动方式

MySQL的事务启动方式有两种：

1. 显示启动事务语句，begin或者start transaction。配套的结束语句是commit，回滚为rollback。
2. set autocommit=0，这个命令会将这个线程的自动提交关闭，意味着如果你只执行一个select语句，事务就启动了，并且不会自动提交。直到你commit或rollback，甚至是强行断开数据库连接。

查询长事务语句

```mysql
-- 查询表中超过60s的事务
select * from {table_name} where time_to_sec(timediff(now(),trx_started)) > 60
```

