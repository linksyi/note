## 如果给字符串加索引

### 前缀索引

​		当我们给字符串添加索引时，有一下两种方式：

```mysql
-- 整个字段加上索引
alter table talbe1 add index index1(column1);
-- 给字段前六位加上索引
alter table talbe1 add index index2(column1(6));
```

​		index1索引在创建时，更消耗资源，但是在查询时如返回字段只有索引字段则不需要进行回表操作，而index2则恰恰相反；因为索引上直保存整个column前6位，所以在返回数据时，需要进行回表查询数据返回结果集。且因为字段子保存前6位，那么在索引判断时只会判断前六位会产生额外的判断。

​		但是如果将index长度改成7，而去查询数据库中只有一条记录时，这样就能做到又节省空间，又不用额外增加太多的查询成本。**我们在建立索引时关注的是区分度，区分度越高越好。因为区分度越高，意味着重复的键值越少。**

​		通过以下语句判断出索引的区分度，并通过修改长度参数建立区分度高的索引能有效节省索引资源。

```mysql
select count(distinct left(column1, 7)) num from table1
```

---

### 前缀索引对覆盖索引的影响

​		由于使用前缀索引，所以索引树上的字段值是不完整的，所以在查询时，返回的结果集需要回表操作，所以前缀索引无法用上覆盖索引。

---

### 其他方式

**1、 倒序存储**

​		这种索引建立方式需要通过业务场景来判断，比如身份证，由于身份证最后6位是随机数，而不是通过地区来决定的数字，所以这样索引的区分度就可以很高。

**2、hash**

​		也可以通过将hash算法将字符串给转换成hash值，然后存入数据库，这样数据库中会是存放一串数字，可以有效节省索引带来的消耗，且增加查询效率，但是由于hash冲突的缘故，会存在额外的计算空间，且无法建立成唯一索引，所以要做好hash冲突处理。